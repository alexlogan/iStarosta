<% title "#{@group.name} - #{@lesson.name}" %>


      <h4>
        <span class="glyphicon glyphicon-education" aria-hidden="true"></span>
        &nbsp;&nbsp;Посещаемость&nbsp;&nbsp;<%= @lesson.attendance %>%
      </h4>

<br/>
<div class="container-fluid">
  <div class="pull-left">
    <%= link_to 'Добавить', new_lesson_log_path, class: can?(:create, @lesson.logs.build) ? "btn btn-success" : "btn btn-success disabled" %>
  </div>
</div>



<table class="table table-responsive">
  <thead>
    <tr>
      <th scope="row"></th>
      <% @grid.column_headers.each do |column_header| %>
          <th><%= link_to column_header.to_formatted_s(:short), edit_lesson_log_path(params[:lesson_id], column_header) %></th>
      <% end %>
    </tr>
  </thead>
 <tbody>
 <% @grid.rows.each do |row| %>
     <tr>
       <th><%= link_to row.header.name, student_path(row.header) %></th>
       <% row.data.each do |data| leave = false %>
           <td>
             <% if data.flag %>
                 <label class="btn btn-primary">
                   <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                 </label>
             <% else
                  if row.header.medical_certificates.any?
                    row.header.medical_certificates.each do |mc|
                      if data.date.between?(mc.from, mc.till)
                        leave = true
                        break
                      end
                    end
                  end
                  if leave %>
                     <label class="btn btn-success">
                       <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>
                     </label>
                 <% else %>
                     <label class="btn btn-danger">
                       <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                     </label>
                 <% end %>
             <% end %>
           </td>
       <% end %>
     </tr>
 <%end %>
 </tbody>
</table>

<div class="container-fluid">

<label class="btn btn-primary ">
  <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
</label>
- Присутствовал <br/><br/>
<label class="btn btn-danger">
  <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
</label>
- Отсутствовал <br/><br/>
<label class="btn btn-success">
  <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>
</label>
- Отсутствовал по справке
</div>
